df_l$names[i] <- str_replace(df_l$names[i], "T0_","")
}
else if (startsWith ( df_l$names[i], "T1") ){
df_l$time[i] <- "T1"
df_l$time_num[i] <- 1
df_l$names[i] <- str_replace(df_l$names[i], "T1_","")
}
else if (startsWith ( df_l$names[i], "T2") ){
df_l$time[i] <- "T2"
df_l$time_num[i] <- 2
df_l$names[i] <- str_replace(df_l$names[i], "T2_","")
}
}
# modify dataframe
# make sure to select only the variables of interest
# make sure variables are either numeric or characters
#
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
df_l <- df_l %>% mutate_at(c("Number_of_Comorbidity" , "cirrosi_epatica" ,  "DM_1", # CKD ,
"DM_2", "HTA"  , "NYHA_2_3" , "NYHA3_4" , "INSRESPCRON_IRC",
"SAPS_III" , "SOFA" , "KDIGO" , "Dead_in_ICU_1",
"RRT_duration_hrs" , "N_days__of_RRT" , "N_days_RRT_FREE" , "Blood_pur",
"N_Circuits" , "N_Filters" , "values", "time_num",
"ICU_LOS_days" , "Latency_hrs" , "Fluids_in_mL" , "HCO_38_4_in_mL",
"at_28d_RRT_1", "at_90d_RRT_1"),       # "Furosemide_mg_hr"
as.numeric)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
df_w <- dplyr::mutate(df_w, across(everything(), as.character))
df_w <- dplyr::select(df_w,
Numero_cartella,
Condition,
T0_pH , T1_pH , T2_pH ,
T0_BE , T1_BE , T2_BE ,
T0_HCO3 , T1_HCO3 , T2_HCO3 ,
T0_K , T1_K , T2_K ,
T0_eGFR ,  T2_eGFR , # T1_eGFR ,
T0_Creat_Mg_dl ,  T2_Creat_Mg_dl , # T1_Creat_Mg_dl ,
T0_Urea_mg_dl ,  T2_Urea_mg_dl , # T1_Urea_mg_dl ,
# Time-invariant predictors (all ~23)
SAPS_III , SOFA , KDIGO ,
#  Dead_in_ICU ,
# Type_of_treatment ,
RRT_duration_hrs ,
N_days__of_RRT , N_days_RRT_FREE ,
Blood_pur ,
N_Circuits , N_Filters ,
#    at_28d_RRT , at_90d_RRT ,
ICU_LOS_days , Latency_hrs ,
Fluids_in_mL , Fluids_in_mL_1 , HCO_38_4_in_mL , Furosemide_mg_hr)
# Number_of_Comorbidity, cirrosi_epatica  , DM_1 ,  DM_2, HTA, NYHA_2_3, NYHA3_4, INSRESPCRON_IRC, # CKD
# df_w <- drop_na(df_w)
df_w <- dplyr::mutate(df_w, across(-c(Numero_cartella,
Condition, #Dead_in_ICU,
Blood_pur, # Type_of_treatment,
#  at_28d_RRT , at_90d_RRT,
Fluids_in_mL, Fluids_in_mL_1 , HCO_38_4_in_mL , Furosemide_mg_hr),
as.numeric))
# df_w <- drop_na(df_w)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
df_w$N_days__of_RRT <- as.numeric(df_w$N_days__of_RRT)
df_w$ICU_LOS_days <- as.numeric(df_w$ICU_LOS_days)
df_w$RRT_duration_percentage <- df_w$N_days__of_RRT * 100 / df_w$ICU_LOS_days
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# rm(df_long, df_long_1, df_wide, df_wide_1)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# Convert to long format and create level categories
df_long <- df_w %>%
pivot_longer(cols = c("Furosemide_mg_hr"),
names_to = "Group",
values_to = "Value") %>%
filter(!is.na(Value)) %>%
mutate(Level = factor(Value, levels = c("5" , "7", "10" , "20" , "40",
"20mg"  ,"20mgx1",  "20mg x2"  ,"20mg x3" , "20mg x4", "20mg/hr 24hr",
"100mg","20mg bolo" , "250mg bolo" )))
# Calculate proportions for each level
df_summary <- df_long %>%
group_by(Level, Condition) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Level) %>%
mutate(proportion = count / sum(count) * 100)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
df_w$Furosemide_mg_hr <- factor(df_w$Furosemide_mg_hr,
levels = c("5" , "7", "10" , "20" , "40",
"20mg"  ,"20mgx1",  "20mg x2"  ,"20mg x3" , "20mg x4", "20mg/hr 24hr",
"100mg","20mg bolo" , "250mg bolo" ))
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
plot <- ggplot(subset(df_w, !is.na(Furosemide_mg_hr)), aes(x = Furosemide_mg_hr, fill = Condition, col = Condition)) +
geom_bar(position = "dodge") +
theme_classic() +
theme(
axis.title.x=element_blank(),
axis.title.y=element_blank())+
theme(axis.text.x = element_text(angle = 30, hjust = 1))+
ggtitle("Furosemide")
plot
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# Convert to long format and create level categories
df_long <- df_w %>%
pivot_longer(cols = c("Fluids_in_mL_1"),
names_to = "Group",
values_to = "Value") %>%
filter(!is.na(Value)) %>%
mutate(Level = factor(Value, levels = c(1000, 1001, 2001)))
# Calculate proportions for each level
df_summary <- df_long %>%
group_by(Level, Condition) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Level) %>%
mutate(proportion = count / sum(count) * 100)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
df_w$Fluids_in_mL_1 <- factor(df_w$Fluids_in_mL_1,
levels = c(1000, 1001, 2001))
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
plot <- ggplot(subset(df_w, !is.na(Fluids_in_mL_1)),
aes(x = Fluids_in_mL_1, fill = Condition, col = Condition)) +
geom_bar(position = "dodge") +
theme_classic() +
theme(
axis.title.x=element_blank(),
axis.title.y=element_blank())+
scale_x_discrete(breaks=c("1000","1001", "2001"),
labels=c("1000", ">1000", ">2000"))+
labs(title = "Fluids in mL, Count & Percentage of Total")
# ggplotly(plot)
plotly1 <- ggplotly(plot)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
plot2 <- ggplot(df_summary, aes(x = Level, y = proportion, fill = Condition)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
limits = c(0, 100),
expand = c(0, 0)) +
scale_x_discrete(breaks=c("1000","1001", "2001"),
labels=c("1000", ">1000", ">2000")) +
labs(title = "Distribution of Groups Across Levels",
x = "Level",
y = "Percentage (%)",
fill = "Condition") +
theme_minimal() +
theme(panel.grid.major.x = element_blank(),
legend.position = "right")
# ggplotly(plot2)
plotly2 <- ggplotly(plot2)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# Display side by side using subplot
subplot(plotly1, plotly2, nrows = 1, margin = 0.05 , titleX = TRUE, titleY = TRUE)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# Convert to long format and create level categories
df_long <- df_w %>%
pivot_longer(cols = c("HCO_38_4_in_mL"),
names_to = "Group",
values_to = "Value") %>%
filter(!is.na(Value)) %>%
mutate(Level = factor(Value, levels = c(100, 200, 250, 300, 400, 500)))
# Calculate proportions for each level
df_summary <- df_long %>%
group_by(Level, Condition) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Level) %>%
mutate(proportion = count / sum(count) * 100)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
df_w$HCO_38_4_in_mL <- factor(df_w$HCO_38_4_in_mL,
levels = c(100, 200, 250, 300, 400, 500))
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
plot <- ggplot(subset(df_w, !is.na(HCO_38_4_in_mL)), aes(x = HCO_38_4_in_mL, fill = Condition, col = Condition)) +
geom_bar(position = "dodge") +
theme_classic() +
theme(
axis.title.x=element_blank(),
axis.title.y=element_blank())+
ggtitle("HCO3 - 8.4% in mL")
# ggplotly(plot)
#plot
plotly1 <- ggplotly(plot)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
plot2 <- ggplot(df_summary, aes(x = Level, y = proportion, fill = Condition)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
limits = c(0, 100),
expand = c(0, 0)) +
labs(title = "Distribution of Groups Across Levels",
x = "Level",
y = "Percentage (%)",
fill = "Condition") +
theme_minimal() +
theme(panel.grid.major.x = element_blank(),
legend.position = "right")
# ggplotly(plot2)
plotly2 <- ggplotly(plot2)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# Display side by side using subplot
subplot(plotly1, plotly2, nrows = 1, margin = 0.05 , titleX = TRUE, titleY = TRUE)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# Convert to long format and create level categories
df_long <- df_w %>%
pivot_longer(cols = c("Furosemide_mg_hr"),
names_to = "Group",
values_to = "Value") %>%
filter(!is.na(Value)) %>%
mutate(Level = factor(Value, levels = c("5" , "7", "10" , "20" , "40",
"20mg"  ,"20mgx1",  "20mg x2"  ,"20mg x3" , "20mg x4", "20mg/hr 24hr",
"100mg","20mg bolo" , "250mg bolo" )))
# Calculate proportions for each level
df_summary <- df_long %>%
group_by(Level, Condition) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Level) %>%
mutate(proportion = count / sum(count) * 100)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
df_w$Furosemide_mg_hr <- factor(df_w$Furosemide_mg_hr,
levels = c("5" , "7", "10" , "20" , "40",
"20mg"  ,"20mgx1",  "20mg x2"  ,"20mg x3" , "20mg x4", "20mg/hr 24hr",
"100mg","20mg bolo" , "250mg bolo" ))
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
plot <- ggplot(subset(df_w, !is.na(Furosemide_mg_hr)), aes(x = Furosemide_mg_hr, fill = Condition, col = Condition)) +
geom_bar(position = "dodge") +
theme_classic() +
theme(
axis.title.x=element_blank(),
axis.title.y=element_blank())+
theme(axis.text.x = element_text(angle = 30, hjust = 1))+
ggtitle("Furosemide")
# ggplotly(plot)
#plot
plotly1 <- ggplotly(plot)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
plot2 <- ggplot(df_summary, aes(x = Level, y = proportion, fill = Condition)) +
geom_bar(stat = "identity", position = "stack", width = 0.7) +
scale_y_continuous(labels = scales::percent_format(scale = 1),
limits = c(0, 100),
expand = c(0, 0)) +
labs(title = "Distribution of Groups Across Levels",
x = "Level",
y = "Percentage (%)",
fill = "Condition") +
theme_minimal() +
theme(legend.position = "right")+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
# ggplotly(plot2)
plotly2 <- ggplotly(plot2)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# Display side by side using subplot
subplot(plotly1, plotly2, nrows = 1, margin = 0.05 , titleX = TRUE, titleY = TRUE)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
#+++++++++++++++++++++++++
# LOAD FILE
directory <- "Dell"  # / Dell / albertof /
#+++++++++++++++++++++++++
## options(contrasts = c("contr.sum","contr.poly") )
# In regression and ANOVA models (including mixed models), categorical variables (a.k.a. factors) are internally turned into numbers â€” a process called contrast coding. This is necessary because R needs to work with numeric predictors. Different contrast schemes influence how R interprets and tests your categorical predictors, especially when interactions are involved.
#+++++++++++++++++++++++++
df_w <- read_xlsx(paste0( "C:/Users/",directory,"/Dropbox/F I L E S/tesi_ema/v_final.xlsx") )
df_w <- dplyr::mutate(df_w, across(everything(), as.character))
df_l <- pivot_longer(df_w,
cols= 36 : 53, # T0_pH : T2_Urea_mg_dl
names_to='names',
values_to='values')
# df_long <- drop_na(df_long)
#
#+++++++++++++++++++++++++
# here i group variables by time and add a new coloumn with the specifications
df_l$time <- NA
df_l$time_num <- NA
for (i in 1:nrow(df_l)){
if (startsWith ( df_l$names[i], "T0") ){
df_l$time[i] <- "T0"
df_l$time_num[i] <- 0
df_l$names[i] <- str_replace(df_l$names[i], "T0_","")
}
else if (startsWith ( df_l$names[i], "T1") ){
df_l$time[i] <- "T1"
df_l$time_num[i] <- 1
df_l$names[i] <- str_replace(df_l$names[i], "T1_","")
}
else if (startsWith ( df_l$names[i], "T2") ){
df_l$time[i] <- "T2"
df_l$time_num[i] <- 2
df_l$names[i] <- str_replace(df_l$names[i], "T2_","")
}
}
# modify dataframe
# make sure to select only the variables of interest
# make sure variables are either numeric or characters
#
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
df_l <- df_l %>% mutate_at(c("Number_of_Comorbidity" , "cirrosi_epatica" ,  "DM_1", # CKD ,
"DM_2", "HTA"  , "NYHA_2_3" , "NYHA3_4" , "INSRESPCRON_IRC",
"SAPS_III" , "SOFA" , "KDIGO" , "Dead_in_ICU_1",
"RRT_duration_hrs" , "N_days__of_RRT" , "N_days_RRT_FREE" , "Blood_pur",
"N_Circuits" , "N_Filters" , "values", "time_num",
"ICU_LOS_days" , "Latency_hrs" , "Fluids_in_mL" , "HCO_38_4_in_mL",
"at_28d_RRT_1", "at_90d_RRT_1"),       # "Furosemide_mg_hr"
as.numeric)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
df_w <- dplyr::mutate(df_w, across(everything(), as.character))
df_w <- dplyr::select(df_w,
Numero_cartella,
Condition,
T0_pH , T1_pH , T2_pH ,
T0_BE , T1_BE , T2_BE ,
T0_HCO3 , T1_HCO3 , T2_HCO3 ,
T0_K , T1_K , T2_K ,
T0_eGFR ,  T2_eGFR , # T1_eGFR ,
T0_Creat_Mg_dl ,  T2_Creat_Mg_dl , # T1_Creat_Mg_dl ,
T0_Urea_mg_dl ,  T2_Urea_mg_dl , # T1_Urea_mg_dl ,
# Time-invariant predictors (all ~23)
SAPS_III , SOFA , KDIGO ,
#  Dead_in_ICU ,
# Type_of_treatment ,
RRT_duration_hrs ,
N_days__of_RRT , N_days_RRT_FREE ,
Blood_pur ,
N_Circuits , N_Filters ,
#    at_28d_RRT , at_90d_RRT ,
ICU_LOS_days , Latency_hrs ,
Fluids_in_mL , Fluids_in_mL_1 , HCO_38_4_in_mL , Furosemide_mg_hr)
# Number_of_Comorbidity, cirrosi_epatica  , DM_1 ,  DM_2, HTA, NYHA_2_3, NYHA3_4, INSRESPCRON_IRC, # CKD
# df_w <- drop_na(df_w)
df_w <- dplyr::mutate(df_w, across(-c(Numero_cartella,
Condition, #Dead_in_ICU,
Blood_pur, # Type_of_treatment,
#  at_28d_RRT , at_90d_RRT,
Fluids_in_mL, Fluids_in_mL_1 , HCO_38_4_in_mL , Furosemide_mg_hr),
as.numeric))
# df_w <- drop_na(df_w)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
df_w$N_days__of_RRT <- as.numeric(df_w$N_days__of_RRT)
df_w$ICU_LOS_days <- as.numeric(df_w$ICU_LOS_days)
df_w$RRT_duration_percentage <- df_w$N_days__of_RRT * 100 / df_w$ICU_LOS_days
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# rm(df_long, df_long_1, df_wide, df_wide_1)
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
# /\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\//\/\/
plot <- ggplot(df_w, aes(x = Condition, fill = Condition, col = Condition)) +
geom_bar() +
geom_text(stat = 'count', aes(label = paste0("Number of observations: ",after_stat(count))), col = "white",  y=c(37,46)) +
theme_classic() +
theme(legend.position = "none")
ggplotly(plot)
#plot
View(df_w)
df_w$N_days__of_RRT
df_w$ICU_LOS_days
df_w$RRT_duration_percentage
View(df_summary)
View(df_long)
df_summary <- df_long %>%
group_by(Level, Condition) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Level)
View(df_summary)
# Calculate proportions for each level
df_summary <- df_long %>%
group_by(Level, Condition) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Level) %>%
mutate(proportion = count / sum(count) * 100)
getwd()
setwd("C:/Users/Dell/Dropbox/F I L E S/CV/DataScienceProjects/SRTTAnalysis")
devtools::document()
devtools::check()
devtools::check()
random_df_w <- data.frame( ID = LETTERS[1:5], matrix(stats::rnorm(5 * 500, mean = 1, sd = 0.1), nrow = 5, ncol = 500))
random_df_l <- as.data.frame(t(random_df_w))
plot_data_for_Dataframes(random_df_l,format = "Long" ,  limit_y_axis_min_max = FALSE, limit_y_axis_lower = 0.8,   limit_y_axis_upper = 1,  design = c(50, 100, 50, 50, 100, 50,  25, 50, 25), function_to_fit = "lm",  span_loess_fitting = 0.25,   standard_error = FALSE,  color_dots = "black", color_line = "grey",  color_intercept = "grey")
plot_data_for_Dataframes(random_df_l,format = "Long" ,  limit_y_axis_min_max = FALSE, limit_y_axis_lower = 0.8,   limit_y_axis_upper = 0.9,  design = c(50, 100, 50, 50, 100, 50,  25, 50, 25), function_to_fit = "lm",  span_loess_fitting = 0.25,   standard_error = FALSE,  color_dots = "black", color_line = "grey",  color_intercept = "grey")
devtools::check()
devtools::check()
?data.table
??data.table
??data.table::first
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
data_wide <- data.frame(id = 999, t(rnorm(12, mean = 1, sd = 0.1)))
View(data_wide)
plot_skills(data_wide, format = "Wide", col_line = "grey",col_dots = "grey")
names(data_wide) <- c("ID", "preRND1", "Train1", "postRND1", "Skill1", "preRND2", "Train2", "postRND2", "Skill2", "preRND3", "Train3", "postRND3", "Skill3")
plot_skills(data_wide, format = "Wide", col_line = "grey",col_dots = "grey")
devtools::document()
devtools::document()
devtools::check()
random_matrix <- matrix(stats::rnorm(5 * 1200, mean = 1, sd = 0.1), nrow = 5, ncol = 1200)
random_df_w <- data.frame(ID = LETTERS[1:5], random_matrix)
random_matrix <- matrix(stats::rnorm(5 * 12, mean = 1, sd = 0.1), nrow = 5, ncol = 12)
random_df_w <- data.frame(ID = LETTERS[1:5], random_matrix)
View(random_df_w)
names(random_df_w) <- c("ID", "preRND1", "Train1", "postRND1", "Skill1", "preRND2", "Train2", "postRND2", "Skill2", "preRND3", "Train3", "postRND3", "Skill3")
plot_skills_for_Dataframes(random_df_w,  format = "Wide",   col_line = "blue", col_dots = "grey")
random_df_l <- as.data.frame(t(random_df_w))
View(random_df_l)
plot_skills_for_Dataframes(random_df_l,  format = "Long",  col_line = "blue",   col_dots = "grey")
data <- random_df_l
data
# find current ID number
current_id <- data[1,]
# remove current ID number
data <- data[-1,]
data
data$var <- rownames(data)
data
df_skill <- data
View(df_skill)
?pivot_longer
data <- tidyr::pivot_longer(data, cols = -var, names_to = "temp", values_to = "value") %>%
dplyr::select(-temp) %>%
tidyr::pivot_wider(names_from = var, values_from = value)
View(data)
data <- df_skill
data <- tidyr::pivot_longer(data, cols = -var, names_to = "temp", values_to = "value") %>%
dplyr::select(-temp)
data <- df_skill
data <- tidyr::pivot_longer(data, cols = -var, names_to = "temp", values_to = "value") %>%
dplyr::select(-temp) %>%
tidyr::pivot_wider(names_from = var, values_from = value)
data <- df_skill
col_names <- data$var
# Transpose everything except var column
data <- as.data.frame(t(data[, -which(names(data) == "var")]))
# Assign var values as column names
colnames(data) <- col_names
df_skill <- dplyr::select(data, starts_with("Skill"))
df_RT <- dplyr::select(data, !starts_with("Skill"))
# standardize names for df_RT
name_sequence <- c("preRND", "SEQ", "postRND")
num_cols <- ncol(df_RT)
sequence_length <- length(name_sequence)
base_names <- rep(name_sequence, length.out = num_cols)
iteration_index <- rep(1:ceiling(num_cols / sequence_length), each = sequence_length, length.out = num_cols)
new_names <- paste0(base_names, "_", iteration_index)
names(df_RT) <- new_names
df_RT <- as.data.frame(df_RT)
df_RT$ID <- current_id
View(df_RT)
current_id
df_RT$ID <- t(current_id)
# standardize names for df_skill
name_sequence <- c("Skill")
num_cols <- ncol(df_skill)
sequence_length <- length(name_sequence)
base_names <- rep(name_sequence, length.out = num_cols)
iteration_index <- rep(1:ceiling(num_cols / sequence_length), each = sequence_length, length.out = num_cols)
new_names <- paste0(base_names, "_", iteration_index)
names(df_skill) <- new_names
df_skill <- as.data.frame(df_skill)
df_skill$ID <- current_id
df_skill$ID <- t(current_id)
# pivot_longer
df_skill <- tidyr::pivot_longer(df_skill,
cols=1:(ncol(df_skill)-1),
names_to='var',
values_to='ResponseTime')
df_RT <- tidyr::pivot_longer(df_RT,
cols=1:(ncol(df_RT)-1),
names_to='var',
values_to='ResponseTime')
# order the x-axis variables as factors
df_RT$var <- factor(df_RT$var, levels = c("preRND_1", "SEQ_1", "postRND_1",
"preRND_2", "SEQ_2", "postRND_2",
"preRND_3", "SEQ_3", "postRND_3",
"preRND_4", "SEQ_4", "postRND_4",
"preRND_5", "SEQ_5", "postRND_5",
"preRND_6", "SEQ_6", "postRND_6"))
df_skill$var <- factor(df_skill$var, levels = c("Skill_1", "Skill_2",
"Skill_3", "Skill_4",
"Skill_5", "Skill_6"))
df_RT$ResponseTime <- as.numeric(df_RT$ResponseTime)
df_skill$ResponseTime <- as.numeric(df_skill$ResponseTime)
df_RT$group <- "A"
df_skill$group <- "A"
df_skill_mean <- Rmisc::summarySE(df_skill, measurevar = "ResponseTime", groupvars = "var", na.rm=T)
df_RT_mean <-  Rmisc::summarySE(df_RT, measurevar = "ResponseTime", groupvars = "var", na.rm=T)
p1 <- ggplot2::ggplot(df_skill, ggplot2::aes(var, ResponseTime))+
ggplot2::geom_point(ggplot2::aes(col = ID), size = 0.5)+
ggplot2::geom_line(ggplot2::aes(group = ID , col = ID), linewidth  = 0.2, alpha = 0.4)+
ggplot2::geom_errorbar(data = df_skill_mean,
ggplot2::aes(x = var, ymin = ResponseTime - se, ymax = ResponseTime + se), linewidth = 2 , width = .1, colour = col_line) +
ggplot2::geom_point(data = df_skill_mean, col = col_dots, size = 4)+
ggplot2::theme_bw()+
ggplot2::theme(legend.position = "none")+
ggplot2::theme(axis.title.x=ggplot2::element_blank())
p2 <- ggplot2::ggplot(df_RT, ggplot2::aes(var, ResponseTime))+
ggplot2::geom_point(ggplot2::aes(col = ID), size = 0.5)+
ggplot2::theme_bw()+
ggplot2::geom_line(ggplot2::aes(group = ID, col = ID), linewidth  = 0.1, alpha =0.4)+
ggplot2::geom_errorbar(data = df_RT_mean,
ggplot2::aes(x = var, ymin = ResponseTime - se, ymax = ResponseTime + se), linewidth = 2 , width = .1, colour = col_line) +
ggplot2::geom_point(data = df_RT_mean, col = col_dots, size = 4)+
ggplot2::theme(legend.position = "none")+
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 30, hjust = 1))+
ggplot2::theme(axis.title.x=ggplot2::element_blank())+
ggplot2::theme(axis.title.y=ggplot2::element_blank())
devtools::document()
devtools::check()
devtools::load_all()
devtools::install()
library(SRTTAnalysis)
devtools::load_all()
devtools::check()
devtools::document()
