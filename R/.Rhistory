# This change in interpretation is what leads to the dramatic shift in t-values and p-values for the main effects.
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
model_A_interaction <- lm(N_days__of_RRT ~ Condition * SOFA + Condition * SAPS_III +
T0_BE + T0_pH + T0_eGFR + T0_HCO3 + T0_K + T0_Creat_Mg_dl + T0_Urea_mg_dl,
data = df_w)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
summary_coeffs_df <- as.data.frame(summary(model_A_interaction)$coefficients)
coeffs_with_stars <- summary_coeffs_df %>%
mutate(
# Create the star column using nested ifelse or dplyr::case_when
Signif. = case_when(
`Pr(>|t|)` < 0.001 ~ "***",
`Pr(>|t|)` < 0.01 ~ "**",
`Pr(>|t|)` < 0.05 ~ "*",
TRUE ~ "" # No star for non-significant values
)
)
# knitr::kable( coeffs_with_stars, caption = "Summary of Model predicting :: RRT_duration_hrs",digits = 3, row.names = TRUE)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# cat("AIC = ",AIC(model_A_interaction), "\n")
# cat("BIC = ",BIC(model_A_interaction), "\n")
# if we expect an interaction ::
# Anova(model_A_interaction, type = 3)
# if testing only the main effects ::
# Anova(model_A_interaction, type = 2)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# emtrends is agnostic to the reference level; it tests the intrinsic property of the group's slope!
# 1. Test the simple slopes for SOFA_c in both Condition groups
# Get the slopes
sofa_slopes <- emmeans::emtrends(model_A_interaction, ~ Condition, var = "SOFA")
slopes_summary <- summary(sofa_slopes, infer = TRUE)
slopes_pairs <- pairs(sofa_slopes)
# Format slopes table
kable(slopes_summary,
digits = 3,
caption = "SOFA Slopes by Condition",
col.names = c("Condition", "Slope", "SE", "df", "Lower CI", "Upper CI", "t-ratio", "p-value"))
# Format pairwise comparisons table
kable(slopes_pairs,
digits = 3,
caption = "Pairwise Comparisons of SOFA Slopes",
col.names = c("Contrast", "Estimate", "SE", "df", "t-ratio", "p-value"))
# 2. Test the simple slopes for SAPS_III_c in both Condition groups
saps_slopes <- emmeans::emtrends(model_A_interaction, ~ Condition, var = "SAPS_III")
saps_summary <- summary(saps_slopes, infer = TRUE)
saps_pairs <- pairs(saps_slopes)
# Format slopes table
kable(saps_summary,
digits = 3,
caption = "SAPS_III Slopes by Condition",
col.names = c("Condition", "Slope", "SE", "df", "Lower CI", "Upper CI", "t-ratio", "p-value"))
# Format pairwise comparisons table
kable(saps_pairs,
digits = 3,
caption = "Pairwise Comparisons of SAPS_III Slopes",
col.names = c("Contrast", "Estimate", "SE", "df", "t-ratio", "p-value"))
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# Create a prediction dataset with SOFA varying
# Hold other variables at their means/reference levels
pred_data <- expand.grid(
SOFA = seq(min(df_w$SOFA, na.rm = TRUE),
max(df_w$SOFA, na.rm = TRUE),
length.out = 100),
Condition = unique(df_w$Condition)
)
# Add other predictors at their means
pred_data$SAPS_III <- mean(df_w$SAPS_III, na.rm = TRUE)
pred_data$T0_BE <- mean(df_w$T0_BE, na.rm = TRUE)
pred_data$T0_pH <- mean(df_w$T0_pH, na.rm = TRUE)
pred_data$T0_eGFR <- mean(df_w$T0_eGFR, na.rm = TRUE)
pred_data$T0_HCO3 <- mean(df_w$T0_HCO3, na.rm = TRUE)
pred_data$T0_K <- mean(df_w$T0_K, na.rm = TRUE)
pred_data$T0_Creat_Mg_dl <- mean(df_w$T0_Creat_Mg_dl, na.rm = TRUE)
pred_data$T0_Urea_mg_dl <- mean(df_w$T0_Urea_mg_dl, na.rm = TRUE)
# Get predictions with confidence intervals
pred_data$predicted <- predict(model_A_interaction, newdata = pred_data)
pred_ci <- predict(model_A_interaction, newdata = pred_data, interval = "confidence")
pred_data$lwr <- pred_ci[, "lwr"]
pred_data$upr <- pred_ci[, "upr"]
# Plot
plot_sofa <- ggplot(pred_data, aes(x = SOFA, y = predicted, color = Condition, fill = Condition)) +
geom_point(data = df_w, aes(x = SOFA, y = N_days_RRT_FREE),
alpha = 0.3, size = 2) +  # Actual data
geom_line(size = 1.2) +  # Predicted lines
geom_ribbon(aes(ymin = lwr, ymax = upr), alpha = 0.2, color = NA) +
labs(x = "SOFA Score",
y = "RRT-Free Days")+
theme_classic2()
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# Create a prediction dataset with SOFA varying
# Hold other variables at their means/reference levels
pred_data <- expand.grid(
SAPS_III = seq(min(df_w$SAPS_III, na.rm = TRUE),
max(df_w$SAPS_III, na.rm = TRUE),
length.out = 100),
Condition = unique(df_w$Condition)
)
# Add other predictors at their means
pred_data$SOFA <- mean(df_w$SOFA, na.rm = TRUE)
pred_data$T0_BE <- mean(df_w$T0_BE, na.rm = TRUE)
pred_data$T0_pH <- mean(df_w$T0_pH, na.rm = TRUE)
pred_data$T0_eGFR <- mean(df_w$T0_eGFR, na.rm = TRUE)
pred_data$T0_HCO3 <- mean(df_w$T0_HCO3, na.rm = TRUE)
pred_data$T0_K <- mean(df_w$T0_K, na.rm = TRUE)
pred_data$T0_Creat_Mg_dl <- mean(df_w$T0_Creat_Mg_dl, na.rm = TRUE)
pred_data$T0_Urea_mg_dl <- mean(df_w$T0_Urea_mg_dl, na.rm = TRUE)
# Get predictions with confidence intervals
pred_data$predicted <- predict(model_A_interaction, newdata = pred_data)
pred_ci <- predict(model_A_interaction, newdata = pred_data, interval = "confidence")
pred_data$lwr <- pred_ci[, "lwr"]
pred_data$upr <- pred_ci[, "upr"]
# Plot
plot_saps <- ggplot(pred_data, aes(x = SAPS_III, y = predicted, color = Condition, fill = Condition)) +
geom_point(data = df_w, aes(x = SAPS_III, y = N_days_RRT_FREE),
alpha = 0.3, size = 2) +  # Actual data
geom_line(size = 1.2) +  # Predicted lines
geom_ribbon(aes(ymin = lwr, ymax = upr), alpha = 0.2, color = NA) +
labs(x = "SAPS_III Score",
y = "RRT-Free Days")+
theme_classic2()
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
grid.arrange(plot_sofa, plot_saps, nrow = 1)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
View(sofa_slopes)
View(pred_data)
# Convert to dataframe
saps_df <- as.data.frame(saps_summary)
# Plot slopes with error bars
ggplot(saps_df, aes(x = Condition, y = SAPS_III.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SAPS-III Slope (Effect on Outcome)",
x = "Condition",
title = "SAPS-III Effect by Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_minimal() +
theme(legend.position = "none")
# Plot slopes with error bars
plot_sofa <- ggplot(sofa_df, aes(x = Condition, y = SAPS_III.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SAPS-III Slope (Effect on Outcome)",
x = "Condition",
title = "SAPS-III Effect by Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_minimal() +
theme(legend.position = "none")
plot_saps <- ggplot(saps_df, aes(x = Condition, y = SAPS_III.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SAPS-III Slope (Effect on Outcome)",
x = "Condition",
title = "SAPS-III Effect by Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_minimal() +
theme(legend.position = "none")
# Plot slopes with error bars
plot_sofa <- ggplot(sofa_df, aes(x = Condition, y = SAPS_III.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SAPS-III Slope (Effect on Outcome)",
x = "Condition",
title = "SAPS-III Effect by Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_minimal() +
theme(legend.position = "none")
sofa_df <- as.data.frame(sofa_summary)
sofa_df <- as.data.frame(slopes_summary)
# Plot slopes with error bars
plot_sofa <- ggplot(sofa_df, aes(x = Condition, y = SAPS_III.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SAPS-III Slope (Effect on Outcome)",
x = "Condition",
title = "SAPS-III Effect by Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_minimal() +
theme(legend.position = "none")
plot_saps <- ggplot(saps_df, aes(x = Condition, y = SAPS_III.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SAPS-III Slope (Effect on Outcome)",
x = "Condition",
title = "SAPS-III Effect by Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_minimal() +
theme(legend.position = "none")
grid.arrange(plot_sofa, plot_saps, nrow = 1)
# Plot slopes with error bars
plot_sofa <- ggplot(sofa_df, aes(x = Condition, y = SOFA.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SOFA Slope (Effect on Outcome)",
x = "Condition",
title = "SAPS-III Effect by Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_minimal() +
theme(legend.position = "none")
# Plot slopes with error bars
plot_sofa <- ggplot(sofa_df, aes(x = Condition, y = SOFA.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SOFA Slope (Effect on Outcome)",
x = "Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_minimal() +
theme(legend.position = "none")
plot_saps <- ggplot(saps_df, aes(x = Condition, y = SAPS_III.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SAPS-III Slope (Effect on Outcome)",
x = "Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_minimal() +
theme(legend.position = "none")
grid.arrange(plot_sofa, plot_saps, nrow = 1)
ggplot(saps_df, aes(x = SAPS_III.trend, y = Condition)) +
geom_vline(xintercept = 0, linetype = "dashed", color = "red", alpha = 0.5) +
geom_pointrange(aes(xmin = lower.CL, xmax = upper.CL),
size = 0.8, linewidth = 1.2) +
labs(x = "SAPS-III Slope (95% CI)",
y = "",
title = "Effect of SAPS-III by Condition") +
theme_classic()
pred <- ggpredict(model_A_interaction,
terms = c("SAPS_III [all]", "Condition"))
?ggpredict
??ggpredict
pred <- ggeffects::ggpredict(model_A_interaction,
terms = c("SAPS_III [all]", "Condition"))
install.packages("ggeffects")
pred <- ggeffects::ggpredict(model_A_interaction,
terms = c("SAPS_III [all]", "Condition"))
# Plot with different slopes visible
plot(pred) +
labs(x = "SAPS-III Score",
y = "Predicted Outcome",
color = "Condition",
title = "SAPS-III Effect by Condition") +
theme_minimal()
pred_sofa <- ggeffects::ggpredict(model_A_interaction,
terms = c("SOFA [all]", "Condition"))
pred_saps <- ggeffects::ggpredict(model_A_interaction,
terms = c("SAPS_III [all]", "Condition"))
plot_sofa <- plot(pred_saps) +
labs(x = "SOFA Score",
y = "Predicted Outcome",
color = "Condition")+
theme_minimal()
plot_saps <- plot(pred_saps) +
labs(x = "SAPS-III Score",
y = "Predicted Outcome",
color = "Condition")+
theme_minimal()
grid.arrange(plot_sofa, plot_saps, nrow = 1)
plot_sofa <- plot(pred_sofa) +
labs(x = "SOFA Score",
y = "Predicted Outcome",
color = "Condition")+
theme_minimal()
plot_saps <- plot(pred_saps) +
labs(x = "SAPS-III Score",
y = "Predicted Outcome",
color = "Condition")+
theme_minimal()
grid.arrange(plot_sofa, plot_saps, nrow = 1)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
model_B_interaction <- lm(N_days_RRT_FREE ~ Condition * SOFA + Condition * SAPS_III +
T0_BE + T0_pH + T0_eGFR + T0_HCO3 + T0_K + T0_Creat_Mg_dl + T0_Urea_mg_dl,
data = df_w)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
summary_coeffs_df <- as.data.frame(summary(model_B)$coefficients)
coeffs_with_stars <- summary_coeffs_df %>%
mutate(
# Create the star column using nested ifelse or dplyr::case_when
Signif. = case_when(
`Pr(>|t|)` < 0.001 ~ "***",
`Pr(>|t|)` < 0.01 ~ "**",
`Pr(>|t|)` < 0.05 ~ "*",
TRUE ~ "" # No star for non-significant values
)
)
# knitr::kable( coeffs_with_stars, caption = "Summary of Model predicting :: RRT_duration_hrs",digits = 3, row.names = TRUE)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# emtrends is agnostic to the reference level; it tests the intrinsic property of the group's slope!
# 1. Test the simple slopes for SOFA_c in both Condition groups
# Get the slopes
sofa_slopes <- emmeans::emtrends(model_B_interaction, ~ Condition, var = "SOFA")
slopes_summary <- summary(sofa_slopes, infer = TRUE)
slopes_pairs <- pairs(sofa_slopes)
# Format slopes table
kable(slopes_summary,
digits = 3,
caption = "SOFA Slopes by Condition",
col.names = c("Condition", "Slope", "SE", "df", "Lower CI", "Upper CI", "t-ratio", "p-value"))
# Format pairwise comparisons table
kable(slopes_pairs,
digits = 3,
caption = "Pairwise Comparisons of SOFA Slopes",
col.names = c("Contrast", "Estimate", "SE", "df", "t-ratio", "p-value"))
# 2. Test the simple slopes for SAPS_III_c in both Condition groups
saps_slopes <- emmeans::emtrends(model_B_interaction, ~ Condition, var = "SAPS_III")
saps_summary <- summary(saps_slopes, infer = TRUE)
saps_pairs <- pairs(saps_slopes)
# Format slopes table
kable(saps_summary,
digits = 3,
caption = "SAPS_III Slopes by Condition",
col.names = c("Condition", "Slope", "SE", "df", "Lower CI", "Upper CI", "t-ratio", "p-value"))
# Format pairwise comparisons table
kable(saps_pairs,
digits = 3,
caption = "Pairwise Comparisons of SAPS_III Slopes",
col.names = c("Contrast", "Estimate", "SE", "df", "t-ratio", "p-value"))
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# Convert to dataframe
sofa_df <- as.data.frame(slopes_summary)
saps_df <- as.data.frame(saps_summary)
# Plot slopes with error bars
plot_sofa <- ggplot(sofa_df, aes(x = Condition, y = SOFA.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SOFA Slope (Effect on Outcome)",
x = "Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_classic2() +
theme(legend.position = "none")
plot_saps <- ggplot(saps_df, aes(x = Condition, y = SAPS_III.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SAPS-III Slope (Effect on Outcome)",
x = "Condition",
subtitle = "Error bars show 95% confidence intervals") +
theme_classic2() +
theme(legend.position = "none")
grid.arrange(plot_sofa, plot_saps, nrow = 1)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
pred_sofa <- ggeffects::ggpredict(model_B_interaction,
terms = c("SOFA [all]", "Condition"))
pred_saps <- ggeffects::ggpredict(model_B_interaction,
terms = c("SAPS_III [all]", "Condition"))
# Plot with different slopes visible
plot_sofa <- plot(pred_sofa) +
labs(x = "SOFA Score",
y = "Predicted Outcome",
color = "Condition")+
theme_minimal()
plot_saps <- plot(pred_saps) +
labs(x = "SAPS-III Score",
y = "Predicted Outcome",
color = "Condition")+
theme_minimal()
grid.arrange(plot_sofa, plot_saps, nrow = 1)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
model_B_interaction <- lm(N_days_RRT_FREE ~ Condition * SOFA + Condition * SAPS_III +
T0_BE + T0_pH + T0_eGFR + T0_HCO3 + T0_K + T0_Creat_Mg_dl + T0_Urea_mg_dl,
data = df_w)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
summary_coeffs_df <- as.data.frame(summary(model_B)$coefficients)
coeffs_with_stars <- summary_coeffs_df %>%
mutate(
# Create the star column using nested ifelse or dplyr::case_when
Signif. = case_when(
`Pr(>|t|)` < 0.001 ~ "***",
`Pr(>|t|)` < 0.01 ~ "**",
`Pr(>|t|)` < 0.05 ~ "*",
TRUE ~ "" # No star for non-significant values
)
)
# knitr::kable( coeffs_with_stars, caption = "Summary of Model predicting :: RRT_duration_hrs",digits = 3, row.names = TRUE)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# emtrends is agnostic to the reference level; it tests the intrinsic property of the group's slope!
# 1. Test the simple slopes for SOFA_c in both Condition groups
# Get the slopes
sofa_slopes <- emmeans::emtrends(model_B_interaction, ~ Condition, var = "SOFA")
slopes_summary <- summary(sofa_slopes, infer = TRUE)
slopes_pairs <- pairs(sofa_slopes)
# Format slopes table
kable(slopes_summary,
digits = 3,
caption = "SOFA Slopes by Condition",
col.names = c("Condition", "Slope", "SE", "df", "Lower CI", "Upper CI", "t-ratio", "p-value"))
# Format pairwise comparisons table
kable(slopes_pairs,
digits = 3,
caption = "Pairwise Comparisons of SOFA Slopes",
col.names = c("Contrast", "Estimate", "SE", "df", "t-ratio", "p-value"))
# 2. Test the simple slopes for SAPS_III_c in both Condition groups
saps_slopes <- emmeans::emtrends(model_B_interaction, ~ Condition, var = "SAPS_III")
saps_summary <- summary(saps_slopes, infer = TRUE)
saps_pairs <- pairs(saps_slopes)
# Format slopes table
kable(saps_summary,
digits = 3,
caption = "SAPS_III Slopes by Condition",
col.names = c("Condition", "Slope", "SE", "df", "Lower CI", "Upper CI", "t-ratio", "p-value"))
# Format pairwise comparisons table
kable(saps_pairs,
digits = 3,
caption = "Pairwise Comparisons of SAPS_III Slopes",
col.names = c("Contrast", "Estimate", "SE", "df", "t-ratio", "p-value"))
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
# Convert to dataframe
sofa_df <- as.data.frame(slopes_summary)
saps_df <- as.data.frame(saps_summary)
# Plot slopes with error bars
plot_sofa <- ggplot(sofa_df, aes(x = Condition, y = SOFA.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SOFA Slope (Effect on Outcome)",
x = "Condition")+
theme_classic2() +
theme(legend.position = "none")
plot_saps <- ggplot(saps_df, aes(x = Condition, y = SAPS_III.trend, color = Condition)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
labs(y = "SAPS-III Slope (Effect on Outcome)",
x = "Condition")+
theme_classic2() +
theme(legend.position = "none")
grid.arrange(plot_sofa, plot_saps, nrow = 1)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
pred_sofa <- ggeffects::ggpredict(model_B_interaction,
terms = c("SOFA [all]", "Condition"))
pred_saps <- ggeffects::ggpredict(model_B_interaction,
terms = c("SAPS_III [all]", "Condition"))
# Plot with different slopes visible
plot_sofa <- plot(pred_sofa) +
labs(x = "SOFA Score",
y = "Predicted Outcome",
color = "Condition")+
theme_minimal()
plot_saps <- plot(pred_saps) +
labs(x = "SAPS-III Score",
y = "Predicted Outcome",
color = "Condition")+
theme_minimal()
grid.arrange(plot_sofa, plot_saps, nrow = 1)
# /\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\//\/\/\\/
sofa_slopes <- emmeans::emtrends(model_A_interaction, var = "t0_pH")
sofa_slopes <- emmeans::emtrends(model_A_interaction, var = "T0_pH")
View(sofa_slopes)
slopes_summary <- summary(sofa_slopes, infer = TRUE)
slopes_pairs <- pairs(sofa_slopes)
# Format slopes table
kable(slopes_summary,
digits = 3,
caption = "SOFA Slopes by Condition",
col.names = c("Condition", "Slope", "SE", "df", "Lower CI", "Upper CI", "t-ratio", "p-value"))
emmeans::emtrends(model_A_interaction, ~ Condition, var = "T0_pH")
emmeans::emtrends(model_A_interaction, var = "T0_pH")
emmeans::emtrends(model_A_interaction, var = "T0_pH")
emmeans::emtrends(model_A_interaction, ~ Condition, var = "T0_pH")
emmeans::emtrends(model_A_interaction)
?emtrends
emmeans::emtrends(model_A_interaction, var = "T0_pH")
summary(emmeans::emtrends(model_A_interaction, var = "T0_pH", by = "Condition"))
emmeans::emtrends(model_A_interaction, var = "T0_pH", by = "Condition")
emmeans::emtrends(model_A_interaction ~ Condition, var = "T0_pH")
emmeans::emtrends(model_A_interaction, ~ Condition, var = "T0_pH")
model_A_interaction <- lm(N_days__of_RRT ~ Condition * SOFA + Condition * SAPS_III +
T0_BE + T0_pH + T0_eGFR + T0_HCO3 + T0_K + T0_Creat_Mg_dl + T0_Urea_mg_dl,
data = df_w)
summary_coeffs_df <- as.data.frame(summary(model_A_interaction)$coefficients)
coeffs_with_stars <- summary_coeffs_df %>%
mutate(
# Create the star column using nested ifelse or dplyr::case_when
Signif. = case_when(
`Pr(>|t|)` < 0.001 ~ "***",
`Pr(>|t|)` < 0.01 ~ "**",
`Pr(>|t|)` < 0.05 ~ "*",
TRUE ~ "" # No star for non-significant values
)
)
knitr::kable( coeffs_with_stars, caption = "Summary of Model predicting :: RRT_duration_hrs",digits = 3, row.names = TRUE)
df_w$Condition <- factor(df_w$Condition, levels = c( "nefr" , "intens"))
model_A_interaction <- lm(N_days__of_RRT ~ Condition * SOFA + Condition * SAPS_III +
T0_BE + T0_pH + T0_eGFR + T0_HCO3 + T0_K + T0_Creat_Mg_dl + T0_Urea_mg_dl,
data = df_w)
summary_coeffs_df <- as.data.frame(summary(model_A_interaction)$coefficients)
coeffs_with_stars <- summary_coeffs_df %>%
mutate(
# Create the star column using nested ifelse or dplyr::case_when
Signif. = case_when(
`Pr(>|t|)` < 0.001 ~ "***",
`Pr(>|t|)` < 0.01 ~ "**",
`Pr(>|t|)` < 0.05 ~ "*",
TRUE ~ "" # No star for non-significant values
)
)
knitr::kable( coeffs_with_stars, caption = "Summary of Model predicting :: RRT_duration_hrs",digits = 3, row.names = TRUE)
emmeans::emtrends(model_A_interaction, ~ 1, var = "T0_BE")
# Calculate the overall slope for T0_BE (no grouping factor)
T0_BE_overall_slope <- emmeans::emtrends(model_A_interaction, ~ 1, var = "T0_BE")
# The result will be a single slope estimate identical to the main effect in the summary
summary(T0_BE_overall_slope, infer = TRUE)
